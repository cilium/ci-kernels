# Kernel config common between arches

# Settings needed to make the vm work.
CONFIG_9P_FS=y
CONFIG_BINFMT_SCRIPT=y
CONFIG_BLK_DEV_INITRD=y
CONFIG_DEVTMPFS=y
CONFIG_NET_9P_VIRTIO=y
CONFIG_NET_9P=y
CONFIG_NET_CORE=y
CONFIG_OVERLAY_FS=y
CONFIG_PCI=y
CONFIG_SYSFS=y
CONFIG_TMPFS=y
CONFIG_TTY=y
CONFIG_UNIX=y
CONFIG_UNIX98_PTYS=y
CONFIG_VIRTIO_CONSOLE=y
CONFIG_VIRTIO_MMIO=y
CONFIG_VIRTIO_NET=y
CONFIG_VIRTIO_PCI=y
CONFIG_VIRTIO=y
CONFIG_VT=y

# Make debugging in gdb work.
CONFIG_RANDOMIZE_BASE=n

# Enable BPF related things
# Please sort lines by alphabet ascending.
CONFIG_BPF_JIT_ALWAYS_ON=y
CONFIG_BPF_JIT=y
CONFIG_BPF_LIRC_MODE2=y
CONFIG_BPF_LSM=y
CONFIG_BPF_PRELOAD=y
CONFIG_BPF_STREAM_PARSER=y
CONFIG_BPF_SYSCALL=y
CONFIG_BPF=y
CONFIG_BPFILTER=y
CONFIG_CGROUP_BPF=y
CONFIG_CGROUP_NET_CLASSID=y
CONFIG_CGROUPS=y
CONFIG_DEBUG_INFO_BTF=y
CONFIG_DEBUG_INFO=y
CONFIG_DEBUG_KERNEL=y
CONFIG_DEBUG_INFO_BTF_MODULES=y
# >= 5.18 has a different toggle for debug info
CONFIG_DEBUG_INFO_DWARF_TOOLCHAIN_DEFAULT=y
CONFIG_DYNAMIC_FTRACE=y
CONFIG_EPOLL=y
CONFIG_EVENTFD=y
CONFIG_FTRACE_SYSCALLS=y
CONFIG_FTRACE=y
CONFIG_FUNCTION_ERROR_INJECTION=y
CONFIG_FUNCTION_TRACER=y
CONFIG_HW_RANDOM=y
CONFIG_IKCONFIG_PROC=y
CONFIG_IKCONFIG=y
CONFIG_INET=y
CONFIG_IPV6=y
CONFIG_KPROBES=y
CONFIG_LIRC=y
CONFIG_MEDIA_RC_SUPPORT=y
CONFIG_MEDIA_SUPPORT=y
CONFIG_MODULES=y
CONFIG_MPTCP=y
CONFIG_MULTIUSER=y
CONFIG_NET_FOU=y
CONFIG_NET=y
CONFIG_NETFILTER_ADVANCED=y
CONFIG_NETFILTER=y
CONFIG_NETKIT=y
CONFIG_NETWORK_FILESYSTEMS=y
CONFIG_NF_CONNTRACK_MARK=y
CONFIG_NF_CONNTRACK=y
CONFIG_PACKET=y
CONFIG_PERF_EVENTS=y
CONFIG_PROC_FS=y
CONFIG_RC_CORE=y
CONFIG_RC_DECODERS=y
CONFIG_SECURITY=y
CONFIG_SECURITYFS=y
CONFIG_STACK_TRACER=y
CONFIG_UPROBE_EVENT=y
CONFIG_UPROBE_EVENTS=y
CONFIG_XDP_SOCKETS=y

# VirtIO
CONFIG_HW_RANDOM_VIRTIO=y
CONFIG_VIRTIO_BALLOON=y

# Get rid of some drivers and obsolete features
CONFIG_ATA=n
CONFIG_DRM=n
CONFIG_ETHERNET=n
CONFIG_EXT3_FS=n
CONFIG_EXT4_FS=n
CONFIG_FDDI=n
CONFIG_HID=n
CONFIG_INPUT_KEYBOARD=n
CONFIG_INPUT_MOUSE=n
CONFIG_INPUT_MOUSEDEV=n
CONFIG_MD=n
CONFIG_NFS_FS=n
CONFIG_PCCARD=n
CONFIG_SOUND=n
CONFIG_UEVENT_HELPER=n
CONFIG_USB_SUPPORT=n
CONFIG_WIRELESS=n
CONFIG_WLAN=n
